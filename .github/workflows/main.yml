name: "evo-ecom-webaap-infra"

on:  workflow_dispatch
permissions:
  id-token: write
  contents: read
jobs: 
  terraforn_init_plan:
    runs-on: HP
    
    steps:
      
      - name: Checkout
        uses: actions/checkout@v5.0.0

      - name: Azure login
        uses: Azure/login@v2.3.0
        with:
          client-id: a2379b8f-962a-4d67-a050-887257ac66d4
          tenant-id: b359a621-bb6d-4038-9c93-604ca0b824a1
          subscription-id: 51a6ae71-472e-4922-8df6-0a01fa72534d
      
      - name: Terraform fmt
        working-directory: environments/dev
        id: fmt
        run: terraform fmt -check
        continue-on-error: true
      
      - name: Terraform Init
        working-directory: environments/dev
        id: init
        run: terraform init -input=false
        
      
      - name: Terraform Validate
        working-directory: environments/dev
        id: validate
        run: terraform validate -no-color
      
      
      - name: Terraform Plan
        working-directory: environments/dev
        id: plan
        run: terraform plan -no-color -input=false
        continue-on-error: true
        

  terraforn_scaning:
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout
        uses: actions/checkout@v5.0.0
        
      - name: tfsec action
        uses: actions/checkout@master
      - name: tfsec
        uses: aquasecurity/tfsec-action@v1.0.3

       

       
